### JAVA无锁
#### 1.先说说java中经常问到的“乐观锁”和“悲观锁”
##### 对于人来说，有乐天派和悲观派。对于乐天派来说，总是会事情往好的方向想，他们认为所有事情总是不太容易发生问题，出错是小概率事件。对于悲观的来所，总是认为出错是一种常态，所以无论什么事都要考虑得面面俱到。
##### 对于并发控制来说， 锁 是一种悲观的策略，因此每次操作都要很小心。如果有多个线程同时访问临界区的资源，那么宁愿牺牲部分性能进行阻塞，所以 锁 会阻塞线程执行。
##### 但是， 无锁 是一种乐观策略，它会假定在资源的访问时没有发生冲突，既然没有发生冲突，那也就不需要阻塞，所有线程都可以在不停顿的状态下执行。那么如果发生冲突怎么办？ 无锁就会使用CAS。一旦检测到发生冲突，就会重试当前操作直到没有冲突。
#### 2.CAS(compare and swap)比较交换
与锁相比，使用CAS会使程序看起来更加复杂一些，但是因为是无锁，所以天然免疫死锁问题，并且线程之间的相互影响也会远远比基于锁的方式要小，没有线程之间频繁的调度，所以要比锁有更好的性能。
##### 实现原理:CAS指令执行时，当且仅当内存地址V的值与预期值A相等时，将内存地址V的值修改为B，否则就什么都不做。整个比较并替换的操作是一个原子操作
简单来说，CAS需要你额外给出一个期待值，也就是你认为这个变量现在应该是什么，如果不是预想的值，说明该值已经被改过了。你就重新读取，再次尝试修改就好了。